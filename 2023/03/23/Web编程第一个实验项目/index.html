<!DOCTYPE html>
<html>
<head>
  <title>
    
    Web编程第一个实验项目 - 
    hsy的博客
  </title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <link rel="shortcut icon" href="/panda.ico" />
  

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/utils/clear.css">

  
<link rel="stylesheet" href="/css/style.css">


<meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="hsy的博客" type="application/atom+xml">
</head>

<body>
  <div class="title">
  <img class="title_img" src="/images/panda.png" /><br>
  <p id="site_title">&nbsphsy的博客&nbsp</p>
</div>
  <div class="navi">
  <a id="navi_item" href="/#" class="menu-item-link">Home</a>
  <a id="navi_item" href="/tags" class="menu-item-link">Tags</a>
  <a id="navi_item" href="/about" class="menu-item-link">About</a>
  <a id="navi_item" href="/search" class="menu-item-link">Search</a>
  
</div>

<hr />

  <div class="main">
    
<link rel="stylesheet" href="/css/post.css">

<post>

  <div class="post_title">
    Web编程第一个实验项目
  </div>

  <br /><br />

  <div id="post_content">
    <h1 id="Web编程第一个实验项目"><a href="#Web编程第一个实验项目" class="headerlink" title="Web编程第一个实验项目"></a>Web编程第一个实验项目</h1><h2 id="题目要求："><a href="#题目要求：" class="headerlink" title="题目要求："></a>题目要求：</h2><p><img src="https://img-blog.csdnimg.cn/20210429232539324.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="项目完成步骤"><a href="#项目完成步骤" class="headerlink" title="项目完成步骤"></a>项目完成步骤</h2><p>使用Node.js和模板库Cheerio，request做一个爬虫代码，爬取<a target="_blank" rel="noopener" href="https://news.sina.com.cn/china/">新浪新闻</a>，<a target="_blank" rel="noopener" href="https://news.163.com/domestic/">网易新闻</a>，<a target="_blank" rel="noopener" href="http://www.chinanews.com/">中国新闻网</a>中的各个部分。<br>下面以新浪新闻为例，分析页面：</p>
<h3 id="1-新闻页面分析"><a href="#1-新闻页面分析" class="headerlink" title="1. 新闻页面分析"></a>1. 新闻页面分析</h3><h4 id="1-1-对某一篇新闻页面元素进行分析："><a href="#1-1-对某一篇新闻页面元素进行分析：" class="headerlink" title="1.1 对某一篇新闻页面元素进行分析："></a>1.1 对<a target="_blank" rel="noopener" href="https://news.sina.com.cn/c/2021-04-22/doc-ikmxzfmk8332048.shtml">某一篇新闻页面</a>元素进行分析：</h4><ul>
<li><p>标题  <code>main-title</code><br><img src="https://img-blog.csdnimg.cn/20210422213219520.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p>作者 <code>show_author</code><br><img src="https://img-blog.csdnimg.cn/2021042221442011.png" alt="在这里插入图片描述"></p>
</li>
<li><p>时间 <code>date</code><br><img src="https://img-blog.csdnimg.cn/20210422213505996.png" alt="在这里插入图片描述"></p>
</li>
<li><p>关键字：正则化匹配：<code>$(&#39;meta[name=\&quot;keywords\&quot;]&#39;).eq(0).attr(\&quot;content\&quot;)&quot;    </code><br><img src="https://img-blog.csdnimg.cn/20210423195744436.png" alt="在这里插入图片描述"></p>
</li>
<li><p>内容 <code>article</code><br><img src="https://img-blog.csdnimg.cn/2021042221394567.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p>来源 <code>source</code><br><img src="https://img-blog.csdnimg.cn/20210422213745926.png" alt="在这里插入图片描述"></p>
<h4 id="1-2-对新闻网页的URL进行分析"><a href="#1-2-对新闻网页的URL进行分析" class="headerlink" title="1.2 对新闻网页的URL进行分析"></a>1.2 对新闻网页的URL进行分析</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://news.sina.com.cn/c/2021-04-23/doc-ikmxzfmk8553784.shtml</span><br><span class="line">https://news.sina.com.cn/c/2021-04-23/doc-ikmyaawc1428218.shtml</span><br><span class="line">https://news.sina.com.cn/o/2021-04-22/doc-ikmxzfmk8371786.shtml</span><br></pre></td></tr></table></figure>
<p>从上述三个网址可知，每个网页都是由</p>
</li>
<li><p><code>https://news.sina.com.cn</code> 网页链接</p>
</li>
<li><p><code>/o/</code> 一个字母</p>
</li>
<li><p><code>2021-04-22</code> 年月日，由四个数字-两个数字-两个数字组成</p>
</li>
<li><p><code>doc-ikmxzfmk8371786.shtml</code> doc-15个字符.shtml<br>因此可以写出匹配网页的正则化为：<code>/\/(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)\/doc-(\w&#123;15&#125;).shtml/</code></p>
</li>
</ul>
<h3 id="2-数据库设计和代码实现"><a href="#2-数据库设计和代码实现" class="headerlink" title="2. 数据库设计和代码实现"></a>2. 数据库设计和代码实现</h3><h5 id="2-1-设计数据库"><a href="#2-1-设计数据库" class="headerlink" title="2.1 设计数据库"></a>2.1 设计数据库</h5><ul>
<li>在mysql中创建数据库<code>crawlnews</code>，然后在该数据库里创建表<code>fetches</code>:<br><img src="https://img-blog.csdnimg.cn/20210423204205188.png" alt="在这里插入图片描述"></li>
<li>根据第1步分析的网页元素，设置fetches表的结构，url设置的属性为<code>UNIQUE</code>，因此插入数据之前需要判断是否已经爬取过相同的网页。<br><img src="https://img-blog.csdnimg.cn/20210423204115211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><h5 id="2-2-数据库连接和查询代码"><a href="#2-2-数据库连接和查询代码" class="headerlink" title="2.2 数据库连接和查询代码"></a>2.2 数据库连接和查询代码</h5></li>
<li>在js爬虫代码中使用mysql，需要先引用mysql文件。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;./mysql.js&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
<li>其中在<code>mysql.js</code>连接数据库，并且完成了带参数和不带参数的sql语句查询。（<em>password需要写自己mysql的密码</em>）<br><img src="https://img-blog.csdnimg.cn/20210429221628207.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><h3 id="3-爬虫具体代码实现"><a href="#3-爬虫具体代码实现" class="headerlink" title="3. 爬虫具体代码实现"></a>3. 爬虫具体代码实现</h3>根据上述新闻分析，实现一个爬虫代码：</li>
</ul>
<h5 id="3-1-网页解析代码实现"><a href="#3-1-网页解析代码实现" class="headerlink" title="3.1 网页解析代码实现"></a>3.1 网页解析代码实现</h5><ul>
<li><p>首先定义我们想要爬取的网页名称和网页URL，和该网页的编码方式（编码方式可以在网页的header中找到）<br><img src="https://img-blog.csdnimg.cn/20210423194424719.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> source_name = <span class="string">&quot;新浪新闻&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> myEncoding = <span class="string">&quot;utf-8&quot;</span>; <span class="comment">//转码成utf-8</span></span><br><span class="line"><span class="keyword">var</span> seedURL = <span class="string">&#x27;https://news.sina.com.cn/china/&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li><p>在代码中定义我们需要爬取的网页的格式：带有<code>a</code>标签，标题从<code>class = main-title</code>中获取，向keywords这种从headers中读取的，就使用正则化进行匹配，每个选择的内容都在<strong>第1.1部分</strong>进行了说明。<br><img src="https://img-blog.csdnimg.cn/20210429210818537.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p>另外，还需要对新浪新闻中的网页进行分析，在<strong>第1.2部分</strong>中进行了解释<br><img src="https://img-blog.csdnimg.cn/20210429210852653.png" alt="在这里插入图片描述"></p>
</li>
</ul>
<p><strong>同理</strong>：网易新闻的页面解析代码为：<br><img src="https://img-blog.csdnimg.cn/20210429210405265.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>      (已提供)中国新闻网的解析代码为：<br><img src="https://img-blog.csdnimg.cn/2021042921051358.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h5 id="3-2-爬虫代码实现"><a href="#3-2-爬虫代码实现" class="headerlink" title="3.2 爬虫代码实现"></a>3.2 爬虫代码实现</h5><ul>
<li><p>需要的模块介绍<br>需要在代码开始导入fs，request，cheerio，iconv-lite和date-utils五个模块，其中fs为node.js内置的。下面为每个模块的含义和示例：</p>
<blockquote>
<p><strong>fs模块</strong>：Node.js 文件系统，提供一组类似 UNIX（POSIX）标准的文件操作API。Node.js 文件系统（fs 模块）模块中的方法均有异步和同步版本，例如读取文件内容的函数有异步的 fs.readFile() 和同步的 fs.readFileSync()。<br>   异步的方法函数最后一个参数为回调函数，回调函数的第一个参数包含了错误信息(error)。建议使用异步方法，比起同步，异步方法性能更高，速度更快，而且没有阻塞。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="comment">// 异步读取</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;input.txt&#x27;</span>, <span class="keyword">function</span> (<span class="params">err, data</span>) &#123;</span><br><span class="line">   <span class="keyword">if</span> (err) &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;异步读取: &quot;</span> + data.<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 同步读取</span></span><br><span class="line"><span class="keyword">var</span> data = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;input.txt&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;同步读取: &quot;</span> + data.<span class="title function_">toString</span>());</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;程序执行完毕。&quot;</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>request</strong>：属于http模块，使用前需要引入http模块，主要作为客户端向HTTP服务器发起请求。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送Get请求</span></span><br><span class="line"><span class="comment">// 第一个参数:请求的完整URL,包括参数</span></span><br><span class="line"><span class="comment">// 第二个参数:请求结果回调函数,会传入3个参数,第一个错误,第二个响应对象,第三个请求数据</span></span><br><span class="line"><span class="title function_">request</span>(url,<span class="keyword">function</span> (<span class="params">error, response, data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data) </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<pre><code>**cheerio**：cheerio是jquery核心功能的一个快速灵活而又简洁的实现，主要是为了用在服务器端需要对DOM进行操作的地方。
</code></pre>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把HTML告诉你的服务器.</span></span><br><span class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> $ = cheerio.<span class="title function_">load</span>(<span class="string">&#x27;&lt;h2 class=&quot;title&quot;&gt;Hello world&lt;/h2&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">&#x27;h2.title&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;Hello there!&#x27;</span>);</span><br><span class="line">$(<span class="string">&#x27;h2&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;welcome&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$.<span class="title function_">html</span>();</span><br><span class="line"><span class="comment">//=&gt; &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h2 class=&quot;title welcome&quot;&gt;Hello there!&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<pre><code>**iconv-lite**：使用纯 javascript 转化字符编码。
</code></pre>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iconv = <span class="built_in">require</span>(<span class="string">&#x27;iconv-lite&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Convert from an encoded buffer to js string. </span></span><br><span class="line">str = iconv.<span class="title function_">decode</span>(<span class="keyword">new</span> <span class="title class_">Buffer</span>([<span class="number">0x68</span>, <span class="number">0x65</span>, <span class="number">0x6c</span>, <span class="number">0x6c</span>, <span class="number">0x6f</span>]), <span class="string">&#x27;win1251&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Convert from js string to an encoded buffer. </span></span><br><span class="line">buf = iconv.<span class="title function_">encode</span>(<span class="string">&quot;Sample input string&quot;</span>, <span class="string">&#x27;win1251&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check if encoding is supported </span></span><br><span class="line">iconv.<span class="title function_">encodingExists</span>(<span class="string">&quot;us-ascii&quot;</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>date-utils</strong>：nodejs日期时间插件。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;date-utils&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> dt = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dt.<span class="title function_">toFormat</span>(<span class="string">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>));</span><br></pre></td></tr></table></figure></li>
<li><p>在代码中导入需要的模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> myRequest = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> myCheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> myIconv = <span class="built_in">require</span>(<span class="string">&#x27;iconv-lite&#x27;</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;date-utils&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
<li><p>设置headers，防止网页屏蔽该爬虫，下面代码为设置的request函数。<br><img src="https://img-blog.csdnimg.cn/20210429220450965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p>实现爬取新闻主页中的所有新闻网页。seedURL为我们需要爬取的新闻主页，因此对新闻主页爬取后对里面所有的链接进行判断，判断是否是一个合理的新闻网页。使用之前找到的新闻网址的规律，进行正则化项匹配，匹配成功后需要调用mysql中的查询函数。</p>
</li>
<li><p>因为需要判断是否爬取过相同的网页，因此实现查询（select）的sql语句:<code>fetch_url_Sql</code>和需要传入的参数（这次处理的网页URL）:<code>fetch_url_Sql_Params</code>，调用mysql的query函数对数据库进行查询，通过有无查询结果来判断之前是否已经爬取。</p>
</li>
<li><p>如果不存在，再对其网页进行爬取，即调用<code>newsGet(myURL)    </code>函数。<br><img src="https://img-blog.csdnimg.cn/20210429220624490.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p>爬取新闻网页。用<code>cheerio</code>解析网页，定义一个新的变量fetch，存储我们需要的标题，作者，内容等等之类的。使用前面定义的<code>title_format</code>，<code>date_format</code>等之类的标准化格式，获取爬取网页中的各个元素。</p>
</li>
<li><p> 函数最后需要将得到的网页元素插入（insert）到<code>fetches</code>表中。实现insert语句的sql代码<code>fetchAddSql</code>和需要插入的网页元素值<code>fetchAddSql_Params</code>，调用mysql中的query函数，对表进行插入操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">newsGet</span>(<span class="params">myURL</span>) &#123; <span class="comment">//读取新闻页面</span></span><br><span class="line">    <span class="title function_">request</span>(myURL, <span class="keyword">function</span>(<span class="params">err, res, body</span>) &#123; <span class="comment">//读取新闻页面</span></span><br><span class="line">        <span class="comment">//try &#123;</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(myURL)</span><br><span class="line">        <span class="keyword">if</span> (body == <span class="literal">undefined</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">var</span> html_news = myIconv.<span class="title function_">decode</span>(body, myEncoding); <span class="comment">//用iconv转换编码</span></span><br><span class="line">        <span class="comment">// console.log(html_news);</span></span><br><span class="line">        <span class="comment">//准备用cheerio解析html_news</span></span><br><span class="line">        <span class="keyword">var</span> $ = myCheerio.<span class="title function_">load</span>(html_news, &#123; <span class="attr">decodeEntities</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">        myhtml = html_news;</span><br><span class="line">        <span class="comment">//&#125; catch (e) &#123;    console.log(&#x27;读新闻页面并转码出错：&#x27; + e);&#125;;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;转码读取成功:&quot;</span> + myURL);</span><br><span class="line">        <span class="comment">//动态执行format字符串，构建json对象准备写入文件或数据库</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> fetch = &#123;&#125;; <span class="comment">//构造一个新的fetch用于存储数据</span></span><br><span class="line">        fetch.<span class="property">title</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        fetch.<span class="property">content</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        fetch.<span class="property">publish_date</span> = (<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">toFormat</span>(<span class="string">&quot;YYYY-MM-DD&quot;</span>);</span><br><span class="line">        <span class="comment">//fetch.html = myhtml;</span></span><br><span class="line">        fetch.<span class="property">url</span> = myURL;</span><br><span class="line">        fetch.<span class="property">source_name</span> = source_name;</span><br><span class="line">        fetch.<span class="property">source_encoding</span> = myEncoding; <span class="comment">//编码</span></span><br><span class="line">        fetch.<span class="property">crawltime</span> = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (keywords_format == <span class="string">&quot;&quot;</span>) fetch.<span class="property">keywords</span> = source_name; <span class="comment">// eval(keywords_format);  //没有关键词就用sourcename</span></span><br><span class="line">        <span class="keyword">else</span> fetch.<span class="property">keywords</span> = <span class="built_in">eval</span>(keywords_format);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (title_format == <span class="string">&quot;&quot;</span>) fetch.<span class="property">title</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">else</span> fetch.<span class="property">title</span> = <span class="built_in">eval</span>(title_format); <span class="comment">//标题</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (date_format != <span class="string">&quot;&quot;</span>) fetch.<span class="property">publish_date</span> = <span class="built_in">eval</span>(date_format); <span class="comment">//刊登日期   </span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;date: &#x27;</span> + fetch.<span class="property">publish_date</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(myURL);</span><br><span class="line">        fetch.<span class="property">publish_date</span> = regExp.<span class="title function_">exec</span>(fetch.<span class="property">publish_date</span>)[<span class="number">0</span>];</span><br><span class="line">        fetch.<span class="property">publish_date</span> = fetch.<span class="property">publish_date</span>.<span class="title function_">replace</span>(<span class="string">&#x27;年&#x27;</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        fetch.<span class="property">publish_date</span> = fetch.<span class="property">publish_date</span>.<span class="title function_">replace</span>(<span class="string">&#x27;月&#x27;</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        fetch.<span class="property">publish_date</span> = fetch.<span class="property">publish_date</span>.<span class="title function_">replace</span>(<span class="string">&#x27;日&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        fetch.<span class="property">publish_date</span> = <span class="keyword">new</span> <span class="title class_">Date</span>(fetch.<span class="property">publish_date</span>).<span class="title function_">toFormat</span>(<span class="string">&quot;YYYY-MM-DD&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (author_format == <span class="string">&quot;&quot;</span>) fetch.<span class="property">author</span> = source_name; <span class="comment">//eval(author_format);  //作者</span></span><br><span class="line">        <span class="keyword">else</span> fetch.<span class="property">author</span> = <span class="built_in">eval</span>(author_format);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (content_format == <span class="string">&quot;&quot;</span>) fetch.<span class="property">content</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> fetch.<span class="property">content</span> = <span class="built_in">eval</span>(content_format).<span class="title function_">replace</span>(<span class="string">&quot;\r\n&quot;</span> + fetch.<span class="property">author</span>, <span class="string">&quot;&quot;</span>); <span class="comment">//内容,是否要去掉作者信息自行决定</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (source_format == <span class="string">&quot;&quot;</span>) fetch.<span class="property">source</span> = fetch.<span class="property">source_name</span>;</span><br><span class="line">        <span class="keyword">else</span> fetch.<span class="property">source</span> = <span class="built_in">eval</span>(source_format).<span class="title function_">replace</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;&quot;</span>); <span class="comment">//来源</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (desc_format == <span class="string">&quot;&quot;</span>) fetch.<span class="property">desc</span> = fetch.<span class="property">title</span>;</span><br><span class="line">        <span class="keyword">else</span> fetch.<span class="property">desc</span> = <span class="built_in">eval</span>(desc_format).<span class="title function_">replace</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;&quot;</span>); <span class="comment">//摘要    </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// var filename = source_name + &quot;_&quot; + (new Date()).toFormat(&quot;YYYY-MM-DD&quot;) +</span></span><br><span class="line">        <span class="comment">//     &quot;_&quot; + myURL.substr(myURL.lastIndexOf(&#x27;/&#x27;) + 1) + &quot;.json&quot;;</span></span><br><span class="line">        <span class="comment">// ////存储json</span></span><br><span class="line">        <span class="comment">// fs.writeFileSync(filename, JSON.stringify(fetch));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//sql插入语句</span></span><br><span class="line">        <span class="keyword">var</span> fetchAddSql = <span class="string">&#x27;INSERT INTO fetches(url,source_name,source_encoding,title,&#x27;</span> +</span><br><span class="line">        <span class="string">&#x27;keywords,author,publish_date,crawltime,content) VALUES(?,?,?,?,?,?,?,?,?)&#x27;</span>;</span><br><span class="line">        <span class="keyword">var</span> fetchAddSql_Params = [fetch.<span class="property">url</span>, fetch.<span class="property">source_name</span>, fetch.<span class="property">source_encoding</span>,</span><br><span class="line">            fetch.<span class="property">title</span>, fetch.<span class="property">keywords</span>, fetch.<span class="property">author</span>, fetch.<span class="property">publish_date</span>,</span><br><span class="line">            fetch.<span class="property">crawltime</span>.<span class="title function_">toFormat</span>(<span class="string">&quot;YYYY-MM-DD HH24:MI:SS&quot;</span>), fetch.<span class="property">content</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行sql，数据库中fetch表里的url属性是unique，不会在数据库中写入重复的url</span></span><br><span class="line">        mysql.<span class="title function_">query</span>(fetchAddSql, fetchAddSql_Params, <span class="keyword">function</span>(<span class="params">qerr, vals, fields</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (qerr) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(qerr);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;); <span class="comment">//写入mysql</span></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>任意一篇新闻爬取结果如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;title&quot;</span>: <span class="string">&quot;河海大学图书借阅排行榜第一的书居然是？|【世界读书日】&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content&quot;</span>: <span class="string">&quot;\n\t\t\t\t　　原标题：河海大学图书借阅排行榜第一的书居然是？|【世界读书日】　　来源:河海大学　　世　　界　　读　　书　　日&quot;</span>,</span><br><span class="line">    <span class="string">&quot;publish_date&quot;</span>: <span class="string">&quot;2021-04-23&quot;</span>,</span><br><span class="line">    <span class="string">&quot;url&quot;</span>: <span class="string">&quot;https://news.sina.com.cn/c/2021-04-23/doc-ikmyaawc1423692.shtml&quot;</span>,</span><br><span class="line">    <span class="string">&quot;source_name&quot;</span>: <span class="string">&quot;新浪新闻&quot;</span>,</span><br><span class="line">    <span class="string">&quot;source_encoding&quot;</span>: <span class="string">&quot;utf-8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;crawltime&quot;</span>: <span class="string">&quot;2021-04-23T11:56:04.698Z&quot;</span>,</span><br><span class="line">    <span class="string">&quot;keywords&quot;</span>: <span class="string">&quot;河海大学图书借阅排行榜第一的书居然是？|【世界读书日】&quot;</span>,</span><br><span class="line">    <span class="string">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;source&quot;</span>: <span class="string">&quot;河海大学&quot;</span>,</span><br><span class="line">    <span class="string">&quot;desc&quot;</span>: <span class="string">&quot;原标题：河海大学图书借阅排行榜第一的书居然是？|【世界读书日】来源:河海大学&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>存储到数据库crawlnews中结果如下：<br><img src="https://img-blog.csdnimg.cn/20210423212301496.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="4-使用Express框架搭建web服务器实现新闻查询和时间热度分析"><a href="#4-使用Express框架搭建web服务器实现新闻查询和时间热度分析" class="headerlink" title="4. 使用Express框架搭建web服务器实现新闻查询和时间热度分析"></a>4. 使用Express框架搭建web服务器实现新闻查询和时间热度分析</h3><h4 id="4-1-安装express"><a href="#4-1-安装express" class="headerlink" title="4.1 安装express"></a>4.1 安装express</h4><blockquote>
<p>Express是一个简单且灵活的node.js Web应用框架，可以快速搭建一个完整功能的网站。</p>
<ul>
<li>可以设置中间件响应HTTP请求</li>
<li>定义路由表执行不同的HTTP请求</li>
<li>通过向模板传递参数来动态渲染HTML页面</li>
</ul>
<p>使用Express脚手架初始化一个规范化项目。</p>
</blockquote>
</li>
</ul>
<p>虽然当项目的路由过多时会使app.js文件很臃肿，但是当前项目没有很多路由，因此使用express脚手架是合理的。</p>
<ol>
<li>使用express脚手架创建一个网站框架<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">express -e search_site</span><br></pre></td></tr></table></figure></li>
<li>在该网页中需要查询mysql中fetches中的数据，因此需要安装<code>mysql</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mysql -save</span><br></pre></td></tr></table></figure></li>
<li>安装其他需要的模块<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure></li>
<li>在cmd中输入<code>node bin/www</code>查看网页<code>127.0.0.1:3000</code>已搭建成功。<br><img src="https://img-blog.csdnimg.cn/20210423215007916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><h4 id="4-2-新闻查询"><a href="#4-2-新闻查询" class="headerlink" title="4.2 新闻查询"></a>4.2 新闻查询</h4></li>
</ol>
<ul>
<li>在search.html网页中实现可以针对标题，内容，关键词进行检索。相应的SQL查询语句为：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> crawlnews </span><br><span class="line"><span class="keyword">WHERE</span> title <span class="keyword">like</span> con1　<span class="keyword">AND</span> keywords <span class="keyword">like</span> con2 <span class="keyword">AND</span> content <span class="keyword">like</span> con3;</span><br></pre></td></tr></table></figure></li>
<li>在search.html中有一个可以输入标题，内容和关键字的表单，用户可以输入想要查询的内容。<br><img src="https://img-blog.csdnimg.cn/20210429224123459.png" alt="在这里插入图片描述"></li>
<li>当后端收到html页面发送的GET请求时，对请求进行解析，使用<code>request.query</code>分别得到标题，内容和关键字的查询内容，然后构造SQL语句，对数据库进行查询。将查询结果作为response返回给网页。</li>
<li>其中的<code>publish_date.toLocaleDateString()</code>语句是将标准时间的publish_date转变为年月日的格式，更加符合观看者的习惯。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2020-01-13T16:00:00.000Z  -&gt;   2020/1/14</span><br></pre></td></tr></table></figure>
<img src="https://img-blog.csdnimg.cn/20210429223935892.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
<li>然后在前端中对response进行解析，在<code>id=record2</code>的地方构造一个table，显示查询后符合的新闻。<br><img src="https://img-blog.csdnimg.cn/20210429224015602.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（虽然有实现分页代码，但因为不能正常显示新闻在网页上，等待之后完善）<h4 id="4-3-时间热度分析"><a href="#4-3-时间热度分析" class="headerlink" title="4.3 时间热度分析"></a>4.3 时间热度分析</h4></li>
<li>在wordhot.html中实现对于一个查询词显示每一天在新闻中出现的次数。相应的SQL查询语句为：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> publish_date,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num </span><br><span class="line"><span class="keyword">FROM</span> fetches <span class="keyword">WHERE</span> title <span class="keyword">like</span> con1 <span class="keyword">GROUP</span> <span class="keyword">BY</span> publish_date <span class="keyword">ORDER</span> <span class="keyword">BY</span> publish_date <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
 需要对publish_date进行分组，计算每个组中新闻的条数。<br> 还可以使用ORDER BY publish_date desc对新闻日期进行降序排序。</li>
<li>首先在wordhot.html中构建一个输入标题的表单。使得用户可以输入想要查询的标题内容。<img src="https://img-blog.csdnimg.cn/20210429225333620.png" alt="在这里插入图片描述"></li>
<li>然后在后端中获取该request，使用<code>request.query.title</code>解析出标题，针对这个标题，利用前面写的SQL语法进行查询，并且将查询值返回。<br><img src="https://img-blog.csdnimg.cn/20210429225404217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
<li>最初，我使用表格显示查询到的数据。在表格中显示日期和总计新闻数。该表格构造的js代码和前一个search.html中的代码类似。<br><img src="https://img-blog.csdnimg.cn/202104292254476.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>显示结果如下：<br><img src="https://img-blog.csdnimg.cn/20210428181736345.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
<li>因为表格的显示不够直观，因此改为折线图展示。导入Echart的js文件，定义一个chart并且使用<code>echarts.init()</code>初始化一个echart图形。在option中填入需要的title，x值，y值，并且设定图形类型为<code>line</code>。<br><img src="https://img-blog.csdnimg.cn/20210429225502322.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><h3 id="5-网页展示"><a href="#5-网页展示" class="headerlink" title="5. 网页展示"></a>5. 网页展示</h3>完成第4步后，又对网页进行了：</li>
</ul>
<ol>
<li> 主页设计：实现了两个功能页面的跳转。</li>
<li>CSS设计：使得页面更加美观</li>
<li>导航栏设计：使得页面的跳转更加方便。<br><img src="https://img-blog.csdnimg.cn/20210429232329941.png" alt="在这里插入图片描述"><br>因此最终网页展示如下：</li>
</ol>
<ul>
<li><p><strong>主页</strong>(localhost:3000):</p>
<pre><code>             可以跳转至：
              -   关键词查询网页（search.html)
              -   时间热度分析网页（wordhot.html)
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20210429234017374.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
</li>
<li><p><strong>关键词查询</strong>网页（search.html):<br>当输入想要查询的词后，可以以列表的形式显示查询结果：</p>
<ul>
<li>仅查询<code>title</code>：<br><img src="https://img-blog.csdnimg.cn/20210429231324527.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
<li>查询<code>title</code>和<code>keywords</code>:<br><img src="https://img-blog.csdnimg.cn/20210429231438814.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
<li>查询<code>title</code>，<code>content</code>和<code>keywords</code>:<br><img src="https://img-blog.csdnimg.cn/20210429231635665.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
</ul>
</li>
<li><p>  <strong>时间热度分析</strong>网页（wordhot.html)</p>
</li>
</ul>
<p>输入想要查询的标题，会显示数据库中的新闻中包含该词的数量，并且按照日期绘制折线图。使得时间热度分析更加直观。<br><img src="https://img-blog.csdnimg.cn/20210429231823278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210429232100562.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0x1Y2t5XzdfNw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li>在本次项目中，理解js代码是如何运行的，该怎么设计一个网站的框架，如何使用代码对网页和服务器进行通信，是比较重要也是我比较薄弱的方面。</li>
<li>实践了使用js进行爬虫和构建网页，学习到了前后端如何通过request和response进行交互，怎么在网页中插入图表，对网页设置CSS，完成了作业的要求。</li>
<li>但因为对js和html代码仍然不太熟悉，因此没有完成分页功能，希望在之后对代码进行改进和优化。</li>
<li>通过本次项目发现，只有真实的完成过任务，才能真正掌握一门语言。希望之后也能主动使用js。</li>
</ul>

  </div>

  <br />

  
  <br /><br />


  

<div class="copyright">

  <a class="license-image" rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by
-nc
-sa
/4.0/"><img alt="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License" style="border-width:0" src="https://i.creativecommons.org/l/by
-nc
-sa
/4.0/80x15.png" />
  </a>

  <p>This work is licensed under a
    <a class="license-word-hyper" rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by
-nc
-sa
/4.0/">
      Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </p>
</div>

  <div id="top">
  <div onclick="window.scrollTo({top: 0, behavior: 'smooth'})">▲</div>
  <div onclick="document.getElementById('footer').scrollIntoView({behavior: 'smooth'})">▼</div>
</div>
  

</post>
  </div>

  <foot id="footer">
  <hr class="boldline" />
  <br>

  <p class="center font">
    
    <a target="_blank" rel="noopener" href="https://github.com/hsy77">
  <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
   <path class="icon_path" d="M427.392 853.504a61.44 61.44 0 0 1-1.450667 15.530667 92.586667 92.586667 0 0 1-10.965333 27.605333c-15.061333 25.301333-40.661333 42.154667-73.642667 42.154667-77.653333 0-108.117333-38.101333-146.261333-133.504C169.216 740.693333 157.013333 725.461333 128 725.461333v-85.333333c77.653333 0 108.117333 38.101333 146.261333 133.504 25.856 64.597333 38.058667 79.786667 67.072 79.786667 0-12.373333-0.170667-23.296-0.512-38.144-0.853333-34.816-0.938667-41.941333 0.554667-51.2 0.64-20.352 5.888-34.773333 16.384-49.066667-95.232-20.736-159.445333-63.573333-196.309333-132.992l-13.824-32.426667C134.186667 510.848 128 467.072 128 416.426667c0-58.24 17.749333-110.336 50.944-153.856-10.368-41.386667-8.96-91.989333 13.909333-149.077334l7.466667-18.688 19.2-6.101333c2.56-0.853333 5.632-1.578667 9.301333-2.133333 37.290667-5.888 90.325333 8.106667 159.701334 52.48a565.930667 565.930667 0 0 1 127.274666-14.208c38.741333 0 77.226667 3.882667 114.048 11.605333 67.456-42.24 119.04-55.509333 155.306667-49.92 3.626667 0.597333 6.741333 1.322667 9.258667 2.133333l19.285333 6.101334 7.466667 18.773333c20.010667 50.218667 23.424 96.469333 16.128 136.96C875.434667 296.32 896 352.597333 896 416.512c0 53.888-3.84 94.378667-14.933333 133.802667l-11.733334 32.170666c-30.677333 69.333333-98.304 112.64-202.538666 133.248 10.837333 15.018667 15.872 30.250667 15.872 52.394667v42.666667l-0.042667 42.666666a13.013333 13.013333 0 0 0 0.341333 2.730667L682.666667 938.794667c-36.352 0-63.36-17.706667-76.672-45.653334a88.277333 88.277333 0 0 1-8.661334-40.277333v-84.736c0-3.584-0.128-3.797333-8.832-12.501333-23.296-23.296-33.834667-40.874667-33.834666-72.832v-38.613334l38.4-3.84c114.346667-11.52 176.512-43.221333 197.12-89.6l9.6-26.325333c7.68-27.562667 10.88-61.098667 10.88-107.946667 0-49.706667-17.365333-90.837333-50.218667-123.648L742.4 274.773333l7.381333-24.448c6.528-21.717333 8.106667-47.402667 1.152-76.714666a158.634667 158.634667 0 0 0-3.584 0.938666c-22.826667 6.4-51.370667 20.053333-85.76 43.008l-15.658666 10.453334-18.304-4.522667a467.754667 467.754667 0 0 0-111.829334-13.269333c-42.709333 0-84.906667 5.418667-123.946666 16.042666l-19.029334 5.205334-16.256-11.136c-35.541333-24.32-65.109333-38.826667-88.746666-45.568a158.293333 158.293333 0 0 0-4.864-1.28c-8.234667 33.92-4.992 61.781333 3.413333 82.688l9.984 25.088-18.346667 19.797333C228.693333 332.629333 213.333333 370.986667 213.333333 416.512c0 41.685333 4.864 76.202667 13.824 102.229333l11.178667 26.453334c27.904 52.352 87.168 83.84 192.853333 95.146666l38.144 4.096v38.357334c0 32-10.538667 49.536-33.834666 72.832-8.704 8.704-8.832 8.96-8.832 12.501333l-0.725334 7.893333c-0.512 2.56-0.512 9.258667 0.170667 37.205334 0.298667 12.8 0.469333 22.997333 0.554667 33.621333a33.962667 33.962667 0 0 1 0.725333 6.656z"/>
  </svg>
 </a>

    
    
    
    <a target="_blank" rel="noopener" href="https://t.me/username">
  <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path d="M834.24 127.872a95.168 95.168 0 0 0-29.856 7.136h-0.128c-9.12 3.616-52.48 21.856-118.4 49.504l-236.224 99.488c-169.504 71.36-336.128 141.632-336.128 141.632l1.984-0.768s-11.488 3.776-23.488 12a64.96 64.96 0 0 0-18.752 18.144c-5.888 8.64-10.624 21.856-8.864 35.52 2.88 23.104 17.856 36.96 28.608 44.608 10.88 7.744 21.248 11.36 21.248 11.36h0.256l156.256 52.64c7.008 22.496 47.616 156 57.376 186.752 5.76 18.368 11.36 29.856 18.368 38.624 3.392 4.48 7.36 8.224 12.128 11.232a35.808 35.808 0 0 0 7.872 3.392l-1.6-0.384c0.48 0.128 0.864 0.512 1.216 0.64 1.28 0.352 2.144 0.48 3.776 0.736 24.736 7.488 44.608-7.872 44.608-7.872l1.12-0.896 92.256-84 154.624 118.624 3.52 1.504c32.224 14.144 64.864 6.272 82.112-7.616 17.376-13.984 24.128-31.872 24.128-31.872l1.12-2.88 119.488-612.128c3.392-15.104 4.256-29.248 0.512-42.976a57.824 57.824 0 0 0-24.992-33.504 59.904 59.904 0 0 0-34.144-8.64z m-3.232 65.6c-0.128 2.016 0.256 1.792-0.64 5.664v0.352l-118.368 605.76c-0.512 0.864-1.376 2.752-3.744 4.64-2.496 1.984-4.48 3.232-14.88-0.896l-189.12-144.992-114.24 104.128 24-153.28 308.992-288c12.736-11.84 8.48-14.336 8.48-14.336 0.896-14.528-19.232-4.256-19.232-4.256l-389.632 241.376-0.128-0.64-186.752-62.88v-0.128l-0.48-0.096a8.64 8.64 0 0 0 0.96-0.384l1.024-0.512 0.992-0.352s166.752-70.272 336.256-141.632c84.864-35.744 170.368-71.744 236.128-99.52 65.76-27.616 114.368-47.872 117.12-48.96 2.624-1.024 1.376-1.024 3.264-1.024z"/>
  </svg>
</a>

    
    
    
    
    
    
    
    
  <p>
    <br>
  <p id="hitokoto">:D 获取中...</p>
  <script src="https://v1.hitokoto.cn/?c=a&encode=js&select=%23hitokoto" defer></script>
  <br>
  <p class="center font">
    &copy - <a href="http://example.com">HeShiYu</a> -  2023 - Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/pcrab/hexo-theme-quark"> Quark </a> 
  </p>
  <p>
    <a href="https://beian.miit.gov.cn/" target="_blank"></a>
  </p>
  <br />
</foot>
</body>

</html>